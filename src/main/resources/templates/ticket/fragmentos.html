<!DOCTYPE html>
<!--
Click nbfs://nbhost/SystemFileSystem/Templates/Licenses/license-default.txt to change this license
Click nbfs://nbhost/SystemFileSystem/Templates/Other/html.html to edit this template
-->
<html>
    <head th:fragment="head" >
        <title>TCS Software</title>
        <meta charset="UTF-8" />
        <link th:href="@{/webjars/bootstrap/css/bootstrap.css}" rel="stylesheet"/>
        <link href="css/estilos.css" rel="stylesheet" type="text/css"/>
        <link th:href="@{/webjars/font-awesome/css/all.css}" rel="stylesheet"/>
        <script th:src="@{/webjars/jquery/jquery.min.js}"></script>
        <script th:src="@{/webjars/popper.js/umd/popper.min.js}"></script>
        <script th:src="@{/webjars/bootstrap/js/bootstrap.min.js}"></script> 
        <script src="/static/js/rutinas.js" type="text/javascript"></script>
    </head>
    <body>
        <!--        <header th:fragment="header" class="header">
                    <nav class="navbar navbar-expand-sm navbar-dark" style="background-color: cornflowerblue">
                        <div class="container-fluid">
                            <a class="navbar-brand" th:href="@{/}">TCS Software</a>
                            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#mynavbar">
                                <span class="navbar-toggler-icon"></span>
                            </button>
                            <div class="collapse navbar-collapse justify-content-end" id="mynavbar">
                                <form class="d-flex">
                                    <input class="form-control me-2" type="text" placeholder="Buscar">
                                    <button class="btn btn-primary" type="button">Buscar</button>  Falta agregar la funcionalidad 
                                </form>
                            </div>
                            <div class="collapse navbar-collapse justify-content-end" id="navoptions">
                                <li class="nav-item dropdown nav">
                                    <a class="nav-link dropdown-toggle navbar-dark text-white" data-bs-toggle="dropdown" href="#" role="button" aria-expanded="false">Lang</a>
                                    <ul class="dropdown-menu dropdown-menu-end">
                                        <li><a class="dropdown-item"  th:href="@{/(lang=es)}">ES</a></li>
                                        <li><a class="dropdown-item" th:href="@{/(lang=en)}">EN</a></li>
                                    </ul>
                                </li>
        
                                <li class="nav-item dropdown nav">
                                    <a class="nav-link dropdown-toggle text-white" data-bs-toggle="dropdown" href="#" role="button" aria-expanded="false"><img
                                            src="https://mdbcdn.b-cdn.net/img/new/avatars/2.webp" 
                                            class="rounded-circle"
                                            height="25"
                                            alt="Retrato"
                                            loading="lazy"
                                            /> Imagen quemada de momento Perfil </a>
                                    <ul class="dropdown-menu dropdown-menu-end">
                                        <a class="dropdown-item"  th:href="@{/(lang=es)}">Mi Perfil</a></li>
                                        <a class="dropdown-item" th:href="@{/(lang=es)}">Configuracion</a>
                                        <a class="dropdown-item" th:href="@{/(lang=es)}">Cerrar Sesion</a>
                                    </ul>
                                </li>
        
        
                            </div>
                        </div>
                        </div>
                    </nav>
                </header>        -->

        <header th:fragment="header" class="header">
            <nav class="navbar navbar-expand-sm navbar-dark bg-dark p-0">
                <div class="container">
                    <a th:href="@{/}" class="navbar-brand">[[#{aplicacion.titulo}]]</a>
                    <button class="navbar-toggler" data-bs-toggle="collapse" data-bs-target="#navbarCollapse">
                        <span class="navbar-toggler-icon"></span>
                    </button>
                    <div class="collapse navbar-collapse justify-content-between" id="navbarCollapse">
                        <ul class="navbar-nav">
                            <li class="nav-item dropdown">
                                <a class="nav-link dropdown-toggle" data-bs-toggle="dropdown" href="#" role="button" aria-expanded="false">Lang</a>
                                <ul class="dropdown-menu dropdown-menu-dark">
                                    <li><a class="dropdown-item"  th:href="@{/(lang=es)}">ES</a></li>
                                    <li><a class="dropdown-item" th:href="@{/(lang=en)}">EN</a></li>
                                </ul>
                            </li>
                        </ul>
                        <ul class="navbar-nav" sec:authorize="!isAuthenticated()">
                            <a th:href="@{/login}" class="btn"><button type="button" class="btn btn-success">Login</button></a>
                        </ul> 
                        <ul class="navbar-nav" sec:authorize="isAuthenticated()">
                            <li class="nav-item text-white my-auto">
                                <i class="fa fa-user"></i> <span sec:authentication="name">Username</span>&nbsp;
                            </li>
                            <li class="nav-item my-auto">
                                <form method="POST" th:action="@{/logout}">
                                    <button class="btn btn-danger">LogOut</button>
                                </form>
                            </li>
                        </ul>
                    </div>
                </div>
            </nav>
        </header>
    <body th:fragment="cuerpo" id="general">
        <div style="background-color: darkslategray">
            <p>En linea</p>
        </div>
        <div class="grid-container" id="herramientas">
            <div class="grid-item" style="border-style:ridge;float:left; width: 400px; padding: 10px; height: 300px; text-align: center">
                <div style="background-color: beige;  height: 20%; padding-top: 15px"><h2 style="font-size:20px ">Herramientas</h2>
                </div>
                <div style="text-align: left; padding-left: 20px">
                    <a class="nav-link" th:href="@{/}">Manual</a> 
                    <a class="nav-link" th:href="@{/}">Contactos</a> 
                    <a class="nav-link" th:href="@{/}">Temas</a> 
                    <a class="nav-link" th:href="@{/}">Calendario</a>
                    <a class="nav-link" th:href="@{/}">Calculadora</a> 
                </div>
            </div>

            <div class="column" style="border-style: ridge;float: left; width: 50%; padding: 10px; height: auto; text-align: center">
                <div style="height: 20%; padding-top: 15px"><h2 style="font-size:20px ">Buscar Usuario</h2>
                </div>
                <div style="text-align: left; padding-left: 20px">
                    <form class="d-flex">
                        <input class="form-control me-2" type="text" placeholder="Buscar"> <!-- Falta agregar la funcionalidad -->
                    </form>
                    <br>
                    <div class="input-group mb-3">
                        <span class="input-group-text" id="basic-addon1">Nombre</span>
                        <input
                            type="text"
                            class="form-control"
                            placeholder="Nombre"
                            aria-label="Nombre"
                            aria-describedby="basic-addon1"
                            />
                    </div>
                    <div class="input-group mb-3">
                        <span class="input-group-text" id="basic-addon1">Apellido</span>
                        <input
                            type="text"
                            class="form-control"
                            placeholder="Apellido"
                            aria-label="Apellido"
                            aria-describedby="basic-addon1"
                            />
                    </div>
                    <div class="input-group mb-3">
                        <input
                            type="text"
                            class="form-control"
                            placeholder="Correo Electronico"
                            aria-label="Correo Electronico"
                            aria-describedby="basic-addon2"
                            />
                        <span class="input-group-text" id="basic-addon2">@example.com</span>
                    </div>


                    <div class="input-group mb-3">
                        <span class="input-group-text">Usuario</span>
                        <input
                            type="text"
                            class="form-control"
                            aria-label="Usuario"
                            />
                    </div>

                    <div class="input-group mb-3">
                        <input
                            type="text"
                            class="form-control"
                            placeholder="Departamento"
                            aria-label="Departamento"
                            />
                    </div>
                    <div>
                        <button class="btn btn-primary" style="justify-content:end" type="button">Buscar</button> <!-- Falta agregar la funcionalidad -->
                    </div>
                </div>
            </div>

            <div class="row" id="grid-container">
                <div class="grid-item" style="border-style: ridge;float: left; width: 380px; padding: 10px; height: 300px; text-align: center">
                    <div style="border-style: ridge; background-color: beige;  height: 20%; padding-top: 15px"><h2 style="font-size:20px ">Tiempo de Respuesta</h2>
                    </div>
                    <div class="stopwatch">
                        <span id="display">00:00:00</span>
                        <button id="startStop" onclick="startStop()">Iniciar</button>
                        <button id="reset" onclick="reset()">Reiniciar</button>
                    </div>




                </div>
                <div class="grid-item" style=" border-style: ridge;float: left; width: 390px; padding: 10px; height: 300px; text-align: center">
                    <div style="background-color: beige; width: 97%; height:20%;"><h2 style="font-size:20px; padding-top: 15px">Detalle Contacto</h2>     
                    </div>
                    <div style="text-align: left; padding-left: 30px">
                        <p><img
                                src="https://mdbcdn.b-cdn.net/img/new/avatars/2.webp" 
                                class="rounded-circle"
                                height="25"
                                alt="Retrato"
                                loading="lazy"
                                /> <!-- Quemada la imagen por el momento tambien --> Esteban Morales</p>
                        <p>Laptop:</p> 
                        <p>Usuario:</p> 
                        <p>Departamento:</p> 
                    </div>
                </div>


            </div>

        </div>
    </body>

    <section th:fragment="listadoTickets" id="tickets" style="margin-top: 10px">
        <div class="container">
            <div class="row">
                <div class="col-md-10">
                    <div class="card">
                        <div class="card-header">
                            <h4>[[#{lista.tickets}]]</h4></div>
                        <div th:if="${tickets != null and !tickets.empty}" >
                            <table class="table table-striped table-hover fs-6">
                                <thead class="table-dark">
                                    <tr><th>#</th>
                                        <th class="text-center">Nombre de Usuario</th>
                                        <th class="text-center">Titulo del Problema</th>
                                        <th class="text-center">Problema</th>
                                        <th class="text-center">Solucion</th>
                                        <th class="text-center">Estado Ticket</th>
                                        <th></th><th></th></tr>
                                </thead>
                                <tbody>
                                    <tr th:each="ticket, contador : ${tickets}">
                                        <td class="text-center">[[${contador.count}]]</td>
                                        <td>[[${ticket.usuario.username}]]</td>
                                        <td class="fs-6">[[${ticket.nombreTicket}]]</td>
                                        <td class="fs-6">[[${ticket.textoProblema}]]</td>
                                        <td class="fs-6">[[${ticket.textoSolucion}]]</td>
                                        <td  class="text-center" th:text="${ticket.estadoTicket} ? 'Activa' : 'Inactiva'" />
                                        <td><a th:href="@{/ticket/eliminar/}+${ticket.idTicket}"
                                               class="btn btn-danger" sec:authorize="hasAnyRole('ROLE_ADMIN')">
                                                <i class="fas fa-trash"></i> [[#{accion.eliminar}]]</a></td>
                                        <td>
                                            <a th:href="@{/ticket/modifica/}+${ticket.idTicket}"
                                               class="btn btn-success" sec:authorize="hasRole('ROLE_ADMIN') or hasRole('ROLE_TECHNICAL')">
                                                <i class="fas fa-pencil"></i> [[#{resolver.ticket}]]</a></td></tr>
                                </tbody>
                            </table>
                            
                        </div>
                        <div class="text-center p-2" th:if="${tickets == null or tickets.empty}">
                            <span>[[#{lista.vacia}]]</span>
                        </div>
                    </div>
                </div>
                <div class="col-md-2">
                    <div class="card text-center bg-success text-white mb-3">
                        <div class="card-body">
                            <h3>Tickets Totales</h3>
                            <h4 class="fs-2"><i class="fas fa-users"></i> [[${totalTickets}]]</h4>
                        </div>
                    </div>
                    <button type="button" class="btn btn-primary" style="margin-left: 20%"><a th:href="@{/reportes/principal}" style="color: white">[[#{reporte.tickets}]]</a></button>
                </div>
            </div>
        </div>
    </section>

    <section th:fragment="editarTicket">
        <div class="row">
            <div class="col-md-2"></div>
            <div class="col-md-8">
                <form method="POST"
                      th:action="@{/ticket/guardar}" th:object="${ticket}"
                      class="was-validated"
                      enctype="multipart/form-data">
                    <input type="hidden" name="idTicket" th:field="*{idTicket}"/>
                    <section th:replace="~{ticket/fragmentos :: botonesEditar}"/>
                    <div id="details">
                        <div class="container">
                            <div class="row">
                                <div class="col">
                                    <div class="card">
                                        <div class="card-header">
                                            <h4>[[#{accion.actualizar}]]</h4>
                                        </div>
                                        <div class="card-body">
                                            <div class="mb-3">
                                                <label for="idTicket">[[#{plantilla.tickets}]]</label>
                                            </div>
                                            <div class="mb-3">
                                                <label for="nombreTicket">[[#{ticket.nombre}]]</label>
                                                <input type="text" class="form-control" 
                                                       th:field="*{nombreTicket}"
                                                       required="true">
                                            </div>
                                            <div class="mb-3">
                                                <label for="textoProblema">[[#{titulo.problema}]]</label>                                    
                                                <textarea class="form-control" 
                                                          th:field="*{textoProblema}" rows="3"></textarea>
                                            </div>

                                            <div class="mb-3">
                                                <label for="textoSolucion">[[#{texto.solucion}]]</label>                                    
                                                <input type="number" class="form-control" 
                                                       th:field="*{textoSolucion}" required="true"/>
                                            </div>
                                            <div class="mb-3">
                                                <label for="estadoTicket">[[#{estado.ticket}]]</label>
                                                <input class="form-check-input" 
                                                       type="checkbox" 
                                                       th:field="*{estadoTicket}" 
                                                       id="activo"/>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </form>
            </div>
        </div>
    </section>


    <section th:fragment="botonesEditar">
        <div class="container py-4 mb-4 bg-light">
            <div class="row">
                <div class="col-md-4 d-grid">
                    <a th:href="@{/ticket/listado}" class="btn btn-primary">
                        <i class="fas fa-arrow-left"></i> [[#{accion.regresar}]]
                    </a>
                </div>
                <div class="col-md-4 d-grid">                                
                    <a th:href="@{/ticket/eliminar/}+${ticket.idProducto}"
                       class="btn btn-danger">
                        <i class="fas fa-trash"></i> [[#{accion.eliminar}]]
                    </a>
                </div>
                <div class="col-md-4 d-grid">
                    <button type="submit" class="btn btn-success">
                        <i class="fas fa-check"></i> [[#{accion.guardar}]]
                    </button>
                </div>
            </div>
        </div>
    </section>


    <footer class="fixed-bottom text-center text-lg-start">
        <nav class="navbar navbar-expand-lg navbar-light"style="background-color: lightblue"
             <!-- Container wrapper -->
            <div class="container-fluid">
                <!-- Toggle button -->
                <button
                    class="navbar-toggler"
                    type="button"
                    data-mdb-toggle="collapse"
                    data-mdb-target="#navbarSupportedContent"
                    aria-controls="navbarSupportedContent"
                    aria-expanded="false"
                    aria-label="Toggle navigation"
                    >
                    <i class="fas fa-bars"></i>
                </button>

                <div class="collapse navbar-collapse" id="navbarSupportedContent">

                </div>

                <div class="d-flex align-items-center">
                    <ul class="navbar-nav me-auto mb-2 mb-lg-0">
                        <li class="nav-item">
                            <a class="nav-link" th:href="@{/}">Clientes</a> 
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" th:href="@{/usuario/listado}">Usuario</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" th:href="@{/tickets/tickets}">Tickets</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" th:href="@{/}">Inicio</a>
                        </li>
                    </ul>

                </div>
            </div>

        </nav>


    </footer>




</html>